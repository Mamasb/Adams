{% extends 'base.html' %}

{% block content %}
    <h2>Reset Your Password</h2>

    <!-- Flash messages -->
    {% with messages = get_flashed_messages(with_categories=True) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }}">{{ message }}</div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <!-- Password Security Features -->
    <p><strong>Password must meet the following criteria:</strong></p>
    <ul>
        <li>At least 8 characters long</li>
        <li>At least one uppercase letter</li>
        <li>At least one lowercase letter</li>
        <li>At least one number</li>
        <li>At least one special character (e.g., !@#$%^&*)</li>
    </ul>

    <!-- Reset Password Form -->
    <form method="POST" action="{{ url_for('reset_password') }}" class="form-container">
        <div class="form-group">
            <label for="new_password">New Password</label>
            <input type="password" name="new_password" id="new_password" placeholder="Enter new password" required>
        </div>

        <div class="form-group">
            <label for="confirm_password">Confirm Password</label>
            <input type="password" name="confirm_password" id="confirm_password" placeholder="Confirm new password" required>
        </div>

        <button type="submit" class="btn-submit">Reset Password</button>
    </form>

    {% if password_reset_success %}
        <p>Password successfully changed! You can now <a href="{{ url_for('login') }}">log in</a> with your new password.</p>
    {% endif %}
{% endblock %}
